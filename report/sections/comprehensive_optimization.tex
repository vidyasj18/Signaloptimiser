\chapter{Traffic Signal Optimization: Complete System Implementation}
\label{ch:comprehensive_optimization}

This chapter is the core of our project. It has a detailed explaination of our project workflow and the results of the project.
\section{System Overview}
\label{sec:system_overview}

The project workflow links four dependable building blocks:
\begin{enumerate}
    \item \textbf{Field data capture:} 30-minute video samples per approach at each intersection.
    \item \textbf{Automated demand estimation:} YOLOv8 counts are converted to PCU values that represent practical lane capacity usage.
    \item \textbf{Signal optimization engines:} Used Webster formula with some ML to find alternatives.
    \item \textbf{Independent validation:} SUMO microsimulation checks whether the suggested plans actually reduce delay and waiting time.
\end{enumerate}

\section{Data Capture and Demand Estimation}
Exported the 360 degree video using Insta360 software in 4 different angles. Uploaded those in Yolo. It took 4 hours to process the video.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{images/insta360softwaresccrenshot.png}
    \caption{Insta360 Studio export interface creating directional feeds for YOLO processing.}
    \label{fig:insta360_export}
\end{figure}

\begin{itemize}
    \item \textbf{Vehicle Detection \& Classification:} Use YOLOv8 to detect and classify vehicles (cars, buses, motorcycles, trucks) in uploaded traffic videos for each intersection approach.
    \item \textbf{Vehicle Counting:} Count vehicles crossing virtual stoplines using tracking algorithms to ensure accurate inbound vehicle counts.
    \item \textbf{PCU Conversion:} Convert raw vehicle counts to Passenger Car Units (PCU) using IRC standards (car=1, bus=3, motorcycle=0.5, truck=3.0) and export the results to a JSON file (\texttt{outputs/intersection\_summary.json}).
\end{itemize}

After detection, the system performs counting and conversion:
\begin{itemize}
    \item \textbf{Inbound Vehicle Counting:} Vehicles crossing the virtual stopline in the inbound direction are counted, with minimum frame requirements to filter out false detections.
    \item \textbf{Vehicle Classification:} Each detected vehicle is classified by type (car, bus, motorcycle, truck, bicycle) based on YOLO's classification output.
    \item \textbf{PCU Conversion:} Raw vehicle counts are converted to Passenger Car Units (PCU) using IRC:106-1990 standards:
    \begin{itemize}
        \item Car: 1.0 PCU
        \item Bus: 3.0 PCU
        \item Motorcycle: 0.5 PCU
        \item Truck: 3.0 PCU
        \item Bicycle: 0.2 PCU
    \end{itemize}
    \item \textbf{Data Export:} The final output is a JSON file (\texttt{outputs/intersection\_summary.json}) containing PCU totals for each approach (N, S, E, W), along with detailed vehicle counts by type.
\end{itemize}

Figure~\ref{fig:yolo_output} shows the Streamlit interface displaying YOLO detection results, including vehicle counts by type, PCU calculations, and per-approach summaries.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.95\textwidth]{images/yolodetectionexample in one of the intersection.png}
    \caption{YOLO detection example with bounding boxes illustrating real-time classifications capability.}
    \label{fig:yolo_output}
\end{figure}

\subsection{YOLO Detection Results}

We processed traffic videos for two key intersections using YOLO detection.

\subsubsection{Intersection 1: Jyoti Circle (3-Approach T-Junction)}

\textbf{YOLO Detection Results:}
\begin{itemize}
    \item \textbf{Total PCU Detected:} 6,802 PCU/hr
    \item \textbf{Approach Breakdown:} NB: 2,542 PCU/hr, SB: 2,760 PCU/hr, WB: 1,500 PCU/hr (3 approaches only - no eastbound approach)
    \item \textbf{Traffic Characteristics:} Highly asymmetric flow distribution (NS: 5,302 PCU vs W: 1,500 PCU, ratio 3.5:1)
\end{itemize}

Figure~\ref{fig:jyoti_detailed_breakdown} shows the detailed breakdown of YOLO detection results for Intersection 1, including comprehensive PCU analysis and vehicle type distribution per approach. The interface clearly shows the 3-approach T-junction configuration with only Northbound, Southbound, and Westbound approaches.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.95\textwidth]{images/1/detailted_breakdown_jyoti.png}
    \caption{YOLO detection breakdown for Jyoti Circle covering PCU and vehicle stats.}
    \label{fig:jyoti_detailed_breakdown}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.95\textwidth]{images/yolo/directionwise_pcu_analysis_jyoticircle.png}
    \caption{Jyoti Circle YOLO data comparison highlighting direction-wise PCU patterns insights.}
    \label{fig:jyoti_yolo_data}
\end{figure}

\subsubsection{Intersection 2: Hampankatta Circle (4-Approach)}

\textbf{YOLO Detection Results:}
\begin{itemize}
    \item \textbf{Total PCU Detected:} 10,680 PCU/hr (57\% higher than Jyoti Circle)
    \item \textbf{Approach Breakdown:} NB: 2,880 PCU/hr, SB: 2,760 PCU/hr, EB: 1,560 PCU/hr, WB: 3,480 PCU/hr
    \item \textbf{Traffic Characteristics:} Relatively balanced flow distribution (NS: 5,640 PCU vs EW: 5,040 PCU, ratio 1.1:1)
\end{itemize}

The Streamlit interface displays the complete YOLO detection output for Intersection 2, showing all four approaches with detailed vehicle classification, PCU conversions, and comprehensive traffic flow data.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.95\textwidth]{images/2/hampankatta_pcu_summary.png}
    \caption{Hampankatta Circle PCU summary detailing per-approach traffic volume profiles clearly.}
    \label{fig:hampankatta_pcu_summary}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.95\textwidth]{images/yolo/directionwise_input_pcu_hampanakatta.png}
    \caption{Hampankatta YOLO data comparison showing direction-wise PCU flow characteristics clearly.}
    \label{fig:hampankatta_yolo_data}
\end{figure}

\section{Calculation(Brain of the system)}

\subsection{Webster's Method (Primary Path)}
Webster's equations convert the PCU values into optimum cycle lengths and proportional green splits, while respecting IRC timing constraints (minimum 60 s cycles, 12 s lost time, fixed amber/all-red intervals). The method's transparency and auditability made it the default optimization path for the final recommendations.

\subsection{Machine Learning Surrogate (Comparative Path)}
Created a synthetic dataset and trained on that. Check the next chapter to know more about.
\section{Webster's Method Optimization}
\label{sec:webster_optimization}


\section{Assumptions and Design Rules}

All signal-control assumptions (saturation flow baseline, phase logic, and timing constants) are consolidated in Chapter~\ref{ch:methodology}, Section~\ref{sec:signal_assumptions}. The Webster, Machine Learning, and SUMO workflows referenced here all inherit that same configuration.

\subsection{Webster's Method Implementation}

Webster's equations consume the PCU totals from YOLO detection and return cycle length plus green splits. See Chapter~\ref{ch:methodology}, Section~\ref{sec:signal_assumptions} for the shared inputs ($L$, $Y$, cycle bounds) that feed this stage.

Figure~\ref{fig:webster_output} shows the Streamlit interface displaying Webster's signal timing optimization results, including the calculated cycle length, per-approach timing parameters, and an interactive phase diagram.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.95\textwidth]{images/intersectoin1websteroutput.png}
    \caption{Streamlit output displaying Webster optimization timings and phase diagram results.}
    \label{fig:webster_output}
\end{figure}

\section{Machine Learning Approach}
\label{sec:ml_approach}

In addition to Webster's analytical method, we implemented a Machine Learning (ML) approach using Random Forest Regressors to predict optimal signal timings. The ML system consists of two models: a cycle length prediction model and a green time split prediction model, both trained on synthetic data generated using Webster's method as ground truth.

The ML approach is designed to learn complex patterns and interactions from training data, potentially capturing non-linear relationships that analytical methods may miss. The models are trained on 3,000 synthetic scenarios incorporating real-world variations including time-of-day effects, weather conditions, special events, and diverse traffic patterns.

For detailed information on ML model architecture, training methodology, performance evaluation, feature importance analysis, and comprehensive comparative results, refer to Chapter~\ref{ch:ml_optimization} (Machine Learning Approach: Comparative Analysis with Webster's Method).

\section{Simulation-Backed Evaluation}

SUMO simulations confirm whether either optimization path actually improves traffic states. The focus is now on interpretable findings instead of screenshots:
\begin{itemize}
    \item \textbf{Jyoti Circle (3-arm):} Webster's proportional allocation handles the asymmetric demand better, lowering average delay by 2.9\% compared to the ML surrogate.
    \item \textbf{Hampankatta Circle (4-arm):} The ML surrogate slightly outperforms Webster (6.4\% lower delay) because it adapts to the balanced four-way interactions.
\end{itemize}
Chapter~\ref{ch:ml_optimization} already lists the granular SUMO metrics (delay, travel time, throughput); duplicating them here offered no additional value and has been removed.

\section{SUMO Microsimulation Validation}
\label{sec:sumo_validation}

\subsection{SUMO Simulation Process}

Both ML-based and Webster-based signal plans were validated through SUMO (Simulation of Urban MObility) microsimulation:

\begin{itemize}
    \item \textbf{Network Generation:} Dynamically creates SUMO network files based on intersection type (3-way T-junction or 4-way intersection). The intersection center junction is configured with an octagonal shape to visually represent a signalized roundaboutâ€”a common design in Indian urban intersections where traffic signals control entry to a circular junction. This geometric representation maintains signal-based control while providing a realistic visual appearance in the simulation
    \item \textbf{Traffic Light Programs:} Converts signal timing plans into SUMO traffic light phase definitions
    \item \textbf{Route Generation:} Creates vehicle routes based on PCU values from YOLO detection
    \item \textbf{Simulation Execution:} Runs identical simulations for both methods under the same traffic conditions
    \item \textbf{Performance Extraction:} Extracts comprehensive metrics including average delay, waiting time, travel time, throughput, and time loss
\end{itemize}

These figures show the complete comparison of ML vs Webster signal plan timings and SUMO simulation metrics for both intersections.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.95\textwidth]{images/1/jyoti_copmarision_timings_and_sumo_metrics.png}
    \caption{ML versus Webster timings and SUMO metrics for Jyoti Circle.}
    \label{fig:jyoti_comparison}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.95\textwidth]{images/2/hampankatta_comparision_timingsa_and_sumo.png}
    \caption{ML versus Webster timings and SUMO metrics for Hampankatta Circle.}
    \label{fig:hampankatta_comparison}
\end{figure}

\subsection{SUMO Simulation Metrics}

Tables~\ref{tab:sumo_int1} and~\ref{tab:sumo_int2} present the complete SUMO validation metrics for both intersections, comparing ML and Webster methods across all performance indicators.

\begin{table}[H]
\centering
\caption{SUMO Validation Metrics - Intersection 1 (Jyoti Circle)}
\label{tab:sumo_int1}
\begin{tabular}{lcc}
\toprule
\textbf{Metric} & \textbf{ML Method} & \textbf{Webster Method} \\
\midrule
Vehicle Count & 4,505 & 4,608 \\
Average Delay (s) & 56.07 & 54.47 \\
Average Waiting Time (s) & 56.07 & 54.47 \\
Average Travel Time (s) & 115.09 & 112.38 \\
Average Time Loss (s) & 82.06 & 79.41 \\
Average Departure Delay (s) & 123.79 & 102.19 \\
Total Delay (s) & 252,599 & 251,009 \\
Total Waiting Time (s) & 252,599 & 251,009 \\
\bottomrule
\end{tabular}
\end{table}

\begin{table}[H]
\centering
\caption{SUMO Validation Metrics - Intersection 2 (Hampankatta Circle)}
\label{tab:sumo_int2}
\begin{tabular}{lcc}
\toprule
\textbf{Metric} & \textbf{ML Method} & \textbf{Webster Method} \\
\midrule
Vehicle Count & 5,882 & 5,867 \\
Average Delay (s) & 82.28 & 87.93 \\
Average Waiting Time (s) & 82.28 & 87.93 \\
Average Travel Time (s) & 147.82 & 156.78 \\
Average Time Loss (s) & 111.70 & 120.20 \\
Average Departure Delay (s) & 482.66 & 480.91 \\
Total Delay (s) & 483,955 & 515,901 \\
Total Waiting Time (s) & 483,955 & 515,901 \\
\bottomrule
\end{tabular}
\end{table}

\subsection{SUMO GUI Simulation Visualizations}

The following figure shows the SUMO-GUI visual simulation for Intersection 1, displaying the signalized roundabout geometry and real-time vehicle movements.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.85\textwidth]{images/1/sumo_jyoti.png}
    \caption{SUMO-GUI view of Jyoti Circle simulation with three-arm operations visualized.}
    \label{fig:sumo_intersection1}
\end{figure}

The following figure shows the SUMO-GUI visual simulation for Intersection 2, displaying the signalized roundabout geometry and real-time vehicle movements.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.85\textwidth]{images/2/hampankatta_sumo_gui.png}
    \caption{SUMO-GUI view of Hampankatta simulation showcasing four-arm traffic dynamics clearly.}
    \label{fig:sumo_intersection2}
\end{figure}

\section{Method Selection and Final Workflow}
Method selection is explained in the next chapter after the comparison of webster and ML.

\subsection{Final Integrated Workflow}

The complete system workflow integrates all components:

\begin{enumerate}
    \item \textbf{YOLO-based Vehicle Detection:} Automated PCU extraction from traffic videos using YOLOv8.
    \item \textbf{Signal Optimization:} Both Webster's method and ML-based approaches are available for generating optimal signal timing plans.
    \item \textbf{SUMO Simulation Validation:} Microsimulation validation of signal plans to compare performance and confirm effectiveness under realistic traffic conditions.
\end{enumerate}

All stages remain integrated within the Streamlit GUI, providing a streamlined workflow from video input to validated signal timing recommendations with side-by-side comparison of optimization methods.

\newpage

